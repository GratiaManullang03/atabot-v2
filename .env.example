# ATABOT 2.0 Environment Configuration - FIXED VERSION
# Copy this file to .env and update with your actual values

# Application Settings
APP_NAME="ATABOT 2.0"
APP_VERSION="2.0.0"
APP_DESCRIPTION="Universal Adaptive Business Intelligence"
DEBUG=True
PORT=8000
LOG_LEVEL=INFO

# Database Configuration (PostgreSQL with pgvector)
DATABASE_URL=postgresql://user:password@localhost:5432/atabot
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=40
DATABASE_POOL_TIMEOUT=30

# VoyageAI API Configuration
VOYAGE_API_KEY=pa-your_voyage_api_key_here
VOYAGE_MODEL=voyage-3.5-lite
VOYAGE_INPUT_TYPE=document
EMBEDDING_DIMENSIONS=1024

# CRITICAL: Rate limiting settings for free tier (3 RPM)
EMBEDDING_BATCH_SIZE=120  # Max texts per API call
VOYAGE_RATE_LIMIT_RPM=3  # Free tier limit
VOYAGE_REQUEST_INTERVAL=21  # Seconds between requests (60/3 + 1 for safety)
VOYAGE_RATE_LIMIT_DELAY=21  # Same as interval

# LLM Configuration (Using Poe API)
POE_API_KEY=p-your_poe_api_key_here
LLM_MODEL=GPT-3.5-Turbo
LLM_MAX_TOKENS=2000
LLM_TEMPERATURE=0.1
LLM_TIMEOUT=30

# Performance Settings
SYNC_BATCH_SIZE=120  # Match embedding batch size
SYNC_MAX_WORKERS=1  # MUST BE 1 to avoid concurrent API calls
VECTOR_SEARCH_LIMIT=10
MAX_CONCURRENT_REQUESTS=1  # Prevent concurrent API calls
QUERY_TIMEOUT=30

# Feature Flags
ENABLE_STREAMING=True
ENABLE_REALTIME_SYNC=False  # Disable until rate limits resolved
ENABLE_CACHE=True  # CRITICAL: Must be true
ENABLE_QUERY_DECOMPOSITION=True
ENABLE_HYBRID_SEARCH=True

# Cache Settings (CRITICAL FOR REDUCING API CALLS)
CACHE_TTL=86400  # 24 hours cache
CACHE_MAX_SIZE=10000  # Increased for better performance
EMBEDDING_CACHE_SIZE=10000  # New: specific cache for embeddings
REDIS_URL=redis://redis:6379/0

# Security
SECRET_KEY=your-secret-key-change-this-in-production
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30

# CORS
CORS_ORIGINS=["*"]
CORS_ALLOW_CREDENTIALS=True
CORS_ALLOW_METHODS=["*"]
CORS_ALLOW_HEADERS=["*"]

# Rate Limiting
RATE_LIMIT_ENABLED=True
RATE_LIMIT_PER_MINUTE=60

# Monitoring
ENABLE_METRICS=True
METRICS_PORT=9090

# Embedding Queue Settings (NEW)
EMBEDDING_QUEUE_MAX_SIZE=1000
EMBEDDING_QUEUE_TIMEOUT=300  # 5 minutes timeout for batch processing
EMBEDDING_RETRY_ATTEMPTS=3
EMBEDDING_RETRY_DELAY=60  # Wait 1 minute between retries